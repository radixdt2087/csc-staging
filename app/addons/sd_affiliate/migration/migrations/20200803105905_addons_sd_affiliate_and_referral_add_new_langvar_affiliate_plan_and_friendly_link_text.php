<?php
 use Phinx\Migration\AbstractMigration; class AddonsSdAffiliateAndReferralAddNewLangvarAffiliatePlanAndFriendlyLinkText extends AbstractMigration { public function up() { $options = $this->adapter->getOptions(); $this->prefix = $options['prefix']; $langvars = [ 'sd_affiliate.affiliate_plan_text' => [ 'en' => 'Your affiliate ID is [user_id]. To receive commission according to the plan you can add <b>[aff_id_?]</b> (or <b>[aff_id_&]</b> if the page link already contains "?") to any link to our store. For example, here is the link for registration of a new affiliate: [link]', 'ru' => 'Ваш партнерский идентификатор [user_id]. Чтобы получать комиссию в соответствии с планом, вы можете добавить <b>[aff_id_?]</b> (или <b>[aff_id_&]</b> если ссылка на страницу уже содержит «?») к любой ссылке в нашем магазине. Например, вот ссылка для регистрации нового партнера: [link]', 'da' => 'Dit tilknyttede id er [user_id]. For at modtage provision i henhold til planen kan du tilføje <b>[aff_id_?]</b> (eller <b> [aff_id_&]</b> hvis sidekoblingen allerede indeholder "?") Til ethvert link til vores butik. For eksempel er her linket til registrering af en ny tilknyttet: [link]', 'de' => 'Ihre Partner-ID lautet [user_id]. Um eine Provision gemäß dem Plan zu erhalten, können Sie jedem Link zu unserem Shop <b>[aff_id_?]</b> (oder <b>[aff_id_&]</b>, wenn der Seitenlink bereits "?" Enthält) hinzufügen. Hier ist zum Beispiel der Link zur Registrierung eines neuen Partners: [link]', 'el' => 'Το αναγνωριστικό συνεργάτη σας είναι [user_id]. Για να λάβετε προμήθεια σύμφωνα με το σχέδιο μπορείτε να προσθέσετε <b>[aff_id_?]</b> (ή <b>[aff_id_&]</b> εάν ο σύνδεσμος σελίδας περιέχει ήδη "?") Σε οποιονδήποτε σύνδεσμο στο κατάστημά μας. Για παράδειγμα, εδώ είναι ο σύνδεσμος για την εγγραφή μιας νέας θυγατρικής: [link]', 'es' => 'Su ID de afiliado es [user_id]. Para recibir una comisión de acuerdo con el plan, puede agregar <b>[aff_id_?]</b> (o <b>[aff_id_&]</b> si el enlace de la página ya contiene "?") A cualquier enlace a nuestra tienda. Por ejemplo, aquí está el enlace para el registro de un nuevo afiliado: [link]', 'fr' => "Votre identifiant d'affilié est [user_id]. Pour recevoir une commission selon le plan, vous pouvez ajouter <b>[aff_id_?]</b> (ou <b>[aff_id_&]</b> si le lien de page contient déjà '?') À n'importe quel lien vers notre boutique. Par exemple, voici le lien pour l'enregistrement d'un nouvel affilié: [link]", 'it' => 'Il tuo ID affiliato è [user_id]. Per ricevere commissioni secondo il piano puoi aggiungere <b>[aff_id_?]</b> (o <b>[aff_id_&]</b> se il link alla pagina contiene già "?") A qualsiasi link al nostro negozio. Ad esempio, ecco il link per la registrazione di un nuovo affiliato: [link]', 'nl' => 'Uw partner-ID is [user_id]. Om commissie volgens het plan te ontvangen, kunt u <b>[aff_id_?]</b> (of <b>[aff_id_&]</b> als de paginalink al "?" Bevat) toevoegen aan een link naar onze winkel. Hier is bijvoorbeeld de link voor registratie van een nieuwe affiliate: [link]', 'no' => 'Ditt tilknyttede ID er [user_id]. For å motta provisjon i henhold til planen kan du legge til <b>[aff_id_?]</b> (eller <b>[aff_id_&]</b> hvis sidelinken allerede inneholder "?") Til en hvilken som helst lenke til butikken vår. Her er for eksempel lenken for registrering av et nytt tilknyttet selskap: [link]', 'ro' => 'ID-ul dvs. de afiliere este [user_id]. Pentru a primi comision conform planului, puteți adăuga <b>[aff_id_?]</b> (sau <b>[aff_id_&]</b> dacă linkul de pagină conține deja "?") La orice link către magazinul nostru. De exemplu, aici este linkul pentru înregistrarea unui nou afiliat: [link]' ], 'sd_affiliate.friendly_link_text' => [ 'en' => 'You can also use the following user-friendly link for the home page to receive commissions according to your plan: [link]', 'ru' => 'Вы также можете использовать следующую удобную ссылку на домашнюю страницу, чтобы получать комиссионные в соответствии с вашим планом: [link]', 'da' => 'Du kan også bruge følgende brugervenlige link til startsiden for at modtage provision i henhold til din plan: [link]', 'de' => 'Sie können auch den folgenden benutzerfreundlichen Link für die Startseite verwenden, um Provisionen gemäß Ihrem Plan zu erhalten: [link]', 'el' => 'Μπορείτε επίσης να χρησιμοποιήσετε τον ακόλουθο φιλικό προς τον χρήστη σύνδεσμο για την αρχική σελίδα για να λαμβάνετε προμήθειες σύμφωνα με το σχέδιό σας: [link]', 'es' => 'También puede usar el siguiente enlace fácil de usar para la página de inicio para recibir comisiones de acuerdo con su plan: [link]', 'fr' => "Vous pouvez également utiliser le lien convivial suivant pour la page d'accueil pour recevoir des commissions en fonction de votre plan: [link]", 'it' => 'Puoi anche utilizzare il seguente link intuitivo per la home page per ricevere commissioni secondo il tuo piano: [link]', 'nl' => 'U kunt ook de volgende gebruiksvriendelijke link gebruiken voor de startpagina om commissies te ontvangen volgens uw plan: [link]', 'no' => 'Du kan også bruke følgende brukervennlige lenke for hjemmesiden for å motta provisjoner i henhold til planen din: [link]', 'ro' => 'Puteți utiliza, de asemenea, următorul link prietenos pentru pagina principală pentru a primi comisioane conform planului dvs.: [link]' ], ]; $this->addOrUpdateLangvars($langvars); } public function down() { } protected function addOrUpdateLangvars($langvars) { foreach ($langvars as $langvar_name => $langvar_values) { foreach ($langvar_values as $lang_code => $langvar_value) { $data = [ 'lang_code' => $lang_code, 'name' => $langvar_name, 'value' => $langvar_value ]; $value = $this->fetchRow( "SELECT value FROM {$this->prefix}language_values" . " WHERE name = '{$data['name']}' AND lang_code = '{$data['lang_code']}'" ); if (empty($value)) { list($fields, $values) = $this->prepareForInsert($data); $this->execute("INSERT INTO {$this->prefix}language_values ({$fields}) VALUES ({$values})"); } else { $this->execute("UPDATE {$this->prefix}language_values" . " SET value = '{$data['value']}'" . " WHERE name = '{$data['name']}' AND lang_code = '{$data['lang_code']}'"); } } } } protected function prepareForInsert($data) { $data = array_map('addslashes', $data); $fields = implode(', ', array_keys($data)); $values = sprintf("'%s'", implode("', '", $data)); return [$fields, $values]; } } 