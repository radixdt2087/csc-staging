<?php
 use Tygh\Enum\AffiliateUserTypes; use Tygh\Notifications\DataProviders\ProfileDataProvider; use Tygh\Notifications\DataValue; use Tygh\Notifications\Transports\Mail\MailMessageSchema; use Tygh\Notifications\Transports\Mail\MailTransport; $schema['profile.password_recover.p'] = [ 'group' => 'profile', 'name' => [ 'template' => 'event.profile.password_recovery.name', 'params' => [ ], ], 'receivers' => [ AffiliateUserTypes::PARTNER => [ MailTransport::getId() => MailMessageSchema::create([ 'area' => 'C', 'from' => 'default_company_users_department', 'to' => DataValue::create('user_data.email'), 'template_code' => 'recover_password', 'legacy_template' => 'profiles/recover_password.tpl', 'language_code' => DataValue::create('user_data.lang_code', CART_LANGUAGE), 'data_modifier' => function (array $data) { return array_merge($data, [ 'url' => fn_url('auth.recover_password?ekey=' . $data['ekey'], 'P'), ]); }, ]), ], ], ]; $schema['profile.updated.p'] = [ 'group' => 'profile', 'name' => [ 'template' => 'event.profile.updated.name', 'params' => [], ], 'data_provider' => [ProfileDataProvider::class, 'factory'], 'receivers' => [ AffiliateUserTypes::PARTNER => [ MailTransport::getId() => MailMessageSchema::create([ 'area' => 'C', 'from' => 'company_users_department', 'to' => DataValue::create('user_data.email'), 'template_code' => 'update_profile', 'legacy_template' => 'profiles/update_profile.tpl', 'company_id' => DataValue::create('user_data.company_id'), 'language_code' => DataValue::create('user_data.lang_code', CART_LANGUAGE) ]), ], ], ]; return $schema; 