<?php
 if (!defined('BOOTSTRAP')) { die('Access denied'); } if ($_SERVER['REQUEST_METHOD'] == 'POST') { return; } if ($mode == 'export') { $params = $_REQUEST; $url = 'sales_reports.view'; if (!empty($params['report_id']) && !empty($params['table_id'])) { $reports = fn_get_order_reports(true, $params['report_id']); if (!empty($reports)) { $report = $reports[$params['report_id']]; if (!empty($report['tables'][$params['table_id']])) { $table = $report['tables'][$params['table_id']]; sd_ZTcxYzdhMDkyZGQwOGJmYTRlNzI5ODY2($table); $parameter = sd_YmU0ZDFmNWIyMDdiN2VjYTVhYzM2MjFh($params['table_id']); $values = fn_get_report_statistics($table); if (!empty($values)) { $_time = TIME; if (sd_N2EwOGQ0ZTAwYmI5MmYzMTE4NDUxMmM3($table, $values, $parameter, $_time)) { $url = fn_url('exim.get_file?filename=' . rawurlencode(str_replace(' ', '_', strtolower($parameter)) . '_' . $_time . '.csv'), 'A', 'current'); fn_set_notification('N', __('notice'), __('text_exim_data_exported')); } else { fn_set_notification('E', __('error'), __('sd_csv_sales_reports.error_exim_no_data_exported')); } } } } } return array(CONTROLLER_STATUS_OK, $url); } elseif ($mode == 'view') { Tygh::$app['view']->assign('sd_check_sales_report_page', true); } 